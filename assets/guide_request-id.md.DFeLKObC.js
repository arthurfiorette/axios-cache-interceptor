import{_ as i,c as a,o as t,ag as e}from"./chunks/framework.CnuuF8_c.js";const C=JSON.parse('{"title":"Request Id","description":"","frontmatter":{},"headers":[],"relativePath":"guide/request-id.md","filePath":"guide/request-id.md","lastUpdated":1766843939000}'),h={name:"guide/request-id.md"};function n(k,s,l,p,r,d){return t(),a("div",null,s[0]||(s[0]=[e(`<div style="display:none;" hidden="true" aria-hidden="true">Are you an LLM? You can read better optimized documentation at /guide/request-id.md for this page in Markdown format</div><h1 id="request-id" tabindex="-1">Request Id <a class="header-anchor" href="#request-id" aria-label="Permalink to &quot;Request Id&quot;">​</a></h1><p>We can distinguish requests from each other by assigning a <strong>non-unique</strong> <code>id</code> to each request. These IDs are the same provided to the storage as keys.</p><p>Each ID is responsible for binding a cache to its request, for referencing or invalidating it later and to make the interceptor use the same cache for requests to the same endpoint and parameters.</p><p>The default id generator is smart enough to generate the same ID for theoretically same requests. <code>{ baseURL: &#39;https://a.com/&#39;, url: &#39;/b&#39; }</code> <strong>==</strong> <code>{ url: &#39;https://a.com/b/&#39; }</code>.</p><div class="vp-code-group vp-adaptive-theme"><div class="tabs"><input type="radio" name="group-0tMay" id="tab-_p4jJFc" checked><label data-title="Different requests" for="tab-_p4jJFc">Different requests</label><input type="radio" name="group-0tMay" id="tab-37WpzWU"><label data-title="Different contexts" for="tab-37WpzWU">Different contexts</label></div><div class="blocks"><div class="language-ts vp-adaptive-theme active"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes kanagawa-wave kanagawa-lotus has-focused-lines vp-code" tabindex="0"><code><span class="line"><span style="--shiki-dark:#FFA066;--shiki-light:#CC6D00;">import </span><span style="--shiki-dark:#DCD7BA;--shiki-light:#545464;">Axios</span><span style="--shiki-dark:#957FB8;--shiki-light:#624C83;"> from</span><span style="--shiki-dark:#98BB6C;--shiki-light:#6F894E;"> &#39;axios&#39;</span><span style="--shiki-dark:#9CABCA;--shiki-light:#4E8CA2;">;</span></span>
<span class="line"><span style="--shiki-dark:#FFA066;--shiki-light:#CC6D00;">import </span><span style="--shiki-dark:#9CABCA;--shiki-light:#4E8CA2;">{</span><span style="--shiki-dark:#DCD7BA;--shiki-light:#545464;"> setupCache</span><span style="--shiki-dark:#9CABCA;--shiki-light:#4E8CA2;"> }</span><span style="--shiki-dark:#957FB8;--shiki-light:#624C83;"> from</span><span style="--shiki-dark:#98BB6C;--shiki-light:#6F894E;"> &#39;axios-cache-interceptor&#39;</span><span style="--shiki-dark:#9CABCA;--shiki-light:#4E8CA2;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#957FB8;--shiki-light:#624C83;">const</span><span style="--shiki-dark:#DCD7BA;--shiki-light:#545464;"> axios </span><span style="--shiki-dark:#E6C384;--shiki-light:#77713F;">=</span><span style="--shiki-dark:#7E9CD8;--shiki-light:#4D699B;"> setupCache</span><span style="--shiki-dark:#9CABCA;--shiki-light:#4E8CA2;">(</span><span style="--shiki-dark:#DCD7BA;--shiki-light:#545464;">Axios</span><span style="--shiki-dark:#9CABCA;--shiki-light:#4E8CA2;">);</span></span>
<span class="line has-focus"><span style="--shiki-dark:#727169;--shiki-light:#716E61;">// These two requests are from completely different endpoints, but they will share</span></span>
<span class="line has-focus"><span style="--shiki-dark:#727169;--shiki-light:#716E61;">// the same resources and cache, as both have the same ID.</span></span>
<span class="line has-focus"><span style="--shiki-dark:#957FB8;--shiki-light:#624C83;">const</span><span style="--shiki-dark:#DCD7BA;--shiki-light:#545464;"> reqA </span><span style="--shiki-dark:#E6C384;--shiki-light:#77713F;">=</span><span style="--shiki-dark:#957FB8;--shiki-dark-font-weight:bold;--shiki-light:#624C83;--shiki-light-font-weight:bold;"> await</span><span style="--shiki-dark:#DCD7BA;--shiki-light:#545464;"> axios</span><span style="--shiki-dark:#9CABCA;--shiki-light:#4E8CA2;">.</span><span style="--shiki-dark:#7E9CD8;--shiki-light:#4D699B;">get</span><span style="--shiki-dark:#9CABCA;--shiki-light:#4E8CA2;">(</span><span style="--shiki-dark:#98BB6C;--shiki-light:#6F894E;">&#39;/a&#39;</span><span style="--shiki-dark:#9CABCA;--shiki-light:#4E8CA2;">,</span><span style="--shiki-dark:#9CABCA;--shiki-light:#4E8CA2;"> {</span><span style="--shiki-dark:#DCD7BA;--shiki-light:#545464;"> id</span><span style="--shiki-dark:#9CABCA;--shiki-light:#4E8CA2;">:</span><span style="--shiki-dark:#98BB6C;--shiki-light:#6F894E;"> &#39;custom-id&#39;</span><span style="--shiki-dark:#9CABCA;--shiki-light:#4E8CA2;"> });</span></span>
<span class="line has-focus"><span style="--shiki-dark:#957FB8;--shiki-light:#624C83;">const</span><span style="--shiki-dark:#DCD7BA;--shiki-light:#545464;"> reqB </span><span style="--shiki-dark:#E6C384;--shiki-light:#77713F;">=</span><span style="--shiki-dark:#957FB8;--shiki-dark-font-weight:bold;--shiki-light:#624C83;--shiki-light-font-weight:bold;"> await</span><span style="--shiki-dark:#DCD7BA;--shiki-light:#545464;"> axios</span><span style="--shiki-dark:#9CABCA;--shiki-light:#4E8CA2;">.</span><span style="--shiki-dark:#7E9CD8;--shiki-light:#4D699B;">get</span><span style="--shiki-dark:#9CABCA;--shiki-light:#4E8CA2;">(</span><span style="--shiki-dark:#98BB6C;--shiki-light:#6F894E;">&#39;/b&#39;</span><span style="--shiki-dark:#9CABCA;--shiki-light:#4E8CA2;">,</span><span style="--shiki-dark:#9CABCA;--shiki-light:#4E8CA2;"> {</span><span style="--shiki-dark:#DCD7BA;--shiki-light:#545464;"> id</span><span style="--shiki-dark:#9CABCA;--shiki-light:#4E8CA2;">:</span><span style="--shiki-dark:#98BB6C;--shiki-light:#6F894E;"> &#39;custom-id&#39;</span><span style="--shiki-dark:#9CABCA;--shiki-light:#4E8CA2;"> });</span></span></code></pre></div><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes kanagawa-wave kanagawa-lotus has-focused-lines vp-code" tabindex="0"><code><span class="line"><span style="--shiki-dark:#FFA066;--shiki-light:#CC6D00;">import </span><span style="--shiki-dark:#DCD7BA;--shiki-light:#545464;">Axios</span><span style="--shiki-dark:#957FB8;--shiki-light:#624C83;"> from</span><span style="--shiki-dark:#98BB6C;--shiki-light:#6F894E;"> &#39;axios&#39;</span><span style="--shiki-dark:#9CABCA;--shiki-light:#4E8CA2;">;</span></span>
<span class="line"><span style="--shiki-dark:#FFA066;--shiki-light:#CC6D00;">import </span><span style="--shiki-dark:#9CABCA;--shiki-light:#4E8CA2;">{</span><span style="--shiki-dark:#DCD7BA;--shiki-light:#545464;"> setupCache</span><span style="--shiki-dark:#9CABCA;--shiki-light:#4E8CA2;"> }</span><span style="--shiki-dark:#957FB8;--shiki-light:#624C83;"> from</span><span style="--shiki-dark:#98BB6C;--shiki-light:#6F894E;"> &#39;axios-cache-interceptor&#39;</span><span style="--shiki-dark:#9CABCA;--shiki-light:#4E8CA2;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#957FB8;--shiki-light:#624C83;">const</span><span style="--shiki-dark:#DCD7BA;--shiki-light:#545464;"> axios </span><span style="--shiki-dark:#E6C384;--shiki-light:#77713F;">=</span><span style="--shiki-dark:#7E9CD8;--shiki-light:#4D699B;"> setupCache</span><span style="--shiki-dark:#9CABCA;--shiki-light:#4E8CA2;">(</span><span style="--shiki-dark:#DCD7BA;--shiki-light:#545464;">Axios</span><span style="--shiki-dark:#9CABCA;--shiki-light:#4E8CA2;">);</span></span>
<span class="line has-focus"><span style="--shiki-dark:#727169;--shiki-light:#716E61;">// You can use the same logic to create two caches for the same endpoint.</span></span>
<span class="line has-focus"><span style="--shiki-dark:#727169;--shiki-light:#716E61;">// Allows you to have different use cases for the coincident same endpoint.</span></span>
<span class="line has-focus"><span style="--shiki-dark:#957FB8;--shiki-light:#624C83;">const</span><span style="--shiki-dark:#DCD7BA;--shiki-light:#545464;"> userForPageX </span><span style="--shiki-dark:#E6C384;--shiki-light:#77713F;">=</span><span style="--shiki-dark:#957FB8;--shiki-dark-font-weight:bold;--shiki-light:#624C83;--shiki-light-font-weight:bold;"> await</span><span style="--shiki-dark:#DCD7BA;--shiki-light:#545464;"> axios</span><span style="--shiki-dark:#9CABCA;--shiki-light:#4E8CA2;">.</span><span style="--shiki-dark:#7E9CD8;--shiki-light:#4D699B;">get</span><span style="--shiki-dark:#9CABCA;--shiki-light:#4E8CA2;">(</span><span style="--shiki-dark:#98BB6C;--shiki-light:#6F894E;">&#39;/users&#39;</span><span style="--shiki-dark:#9CABCA;--shiki-light:#4E8CA2;">,</span><span style="--shiki-dark:#9CABCA;--shiki-light:#4E8CA2;"> {</span><span style="--shiki-dark:#DCD7BA;--shiki-light:#545464;"> id</span><span style="--shiki-dark:#9CABCA;--shiki-light:#4E8CA2;">:</span><span style="--shiki-dark:#98BB6C;--shiki-light:#6F894E;"> &#39;users-page-x&#39;</span><span style="--shiki-dark:#9CABCA;--shiki-light:#4E8CA2;"> });</span></span>
<span class="line has-focus"><span style="--shiki-dark:#957FB8;--shiki-light:#624C83;">const</span><span style="--shiki-dark:#DCD7BA;--shiki-light:#545464;"> userForPageY </span><span style="--shiki-dark:#E6C384;--shiki-light:#77713F;">=</span><span style="--shiki-dark:#957FB8;--shiki-dark-font-weight:bold;--shiki-light:#624C83;--shiki-light-font-weight:bold;"> await</span><span style="--shiki-dark:#DCD7BA;--shiki-light:#545464;"> axios</span><span style="--shiki-dark:#9CABCA;--shiki-light:#4E8CA2;">.</span><span style="--shiki-dark:#7E9CD8;--shiki-light:#4D699B;">get</span><span style="--shiki-dark:#9CABCA;--shiki-light:#4E8CA2;">(</span><span style="--shiki-dark:#98BB6C;--shiki-light:#6F894E;">&#39;/users&#39;</span><span style="--shiki-dark:#9CABCA;--shiki-light:#4E8CA2;">,</span><span style="--shiki-dark:#9CABCA;--shiki-light:#4E8CA2;"> {</span><span style="--shiki-dark:#DCD7BA;--shiki-light:#545464;"> id</span><span style="--shiki-dark:#9CABCA;--shiki-light:#4E8CA2;">:</span><span style="--shiki-dark:#98BB6C;--shiki-light:#6F894E;"> &#39;users-page-y&#39;</span><span style="--shiki-dark:#9CABCA;--shiki-light:#4E8CA2;"> });</span></span></code></pre></div></div></div><div class="warning custom-block"><p class="custom-block-title">WARNING</p><p>If you send two different requests forcefully with the same ID. This library will ignore any possible differences between them and share the same cache for both.</p></div><h2 id="custom-generator" tabindex="-1">Custom Generator <a class="header-anchor" href="#custom-generator" aria-label="Permalink to &quot;Custom Generator&quot;">​</a></h2><p>By default, the id generator extracts <code>method</code>, <code>baseURL</code>, <code>query</code>, <code>params</code>, <code>data</code> and <code>url</code> properties from the request object and hashes it into a number with <a href="https://www.npmjs.com/package/object-code" target="_blank" rel="noreferrer"><code>object-code</code></a>.</p><p>While this default implementation offers reasonable uniqueness for most scenarios, it’s worth noting that there’s a <a href="https://preshing.com/20110504/hash-collision-probabilities/" target="_blank" rel="noreferrer">theoretical 50% probability of collisions after approximately 77,000 keys</a> have been generated.</p><p>However, this limitation is typically inconsequential in browser environments due to their 5MB storage limit, which is reached long before the collision threshold.</p><div class="warning custom-block"><p class="custom-block-title">WARNING</p><p>Consider implementing a custom key generator function using libraries like <a href="https://www.npmjs.com/package/object-hash" target="_blank" rel="noreferrer"><code>object-hash</code></a> for generating hash keys with significantly lower collision probabilities when hitting over 77K unique keys is a possibility</p></div><p>Here’s an example of a generator that only uses the <code>url</code> and <code>method</code> and <code>custom</code> properties:</p><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes kanagawa-wave kanagawa-lotus vp-code" tabindex="0"><code><span class="line"><span style="--shiki-dark:#FFA066;--shiki-light:#CC6D00;">import </span><span style="--shiki-dark:#DCD7BA;--shiki-light:#545464;">Axios</span><span style="--shiki-dark:#957FB8;--shiki-light:#624C83;"> from</span><span style="--shiki-dark:#98BB6C;--shiki-light:#6F894E;"> &#39;axios&#39;</span><span style="--shiki-dark:#9CABCA;--shiki-light:#4E8CA2;">;</span></span>
<span class="line"><span style="--shiki-dark:#FFA066;--shiki-light:#CC6D00;">import </span><span style="--shiki-dark:#9CABCA;--shiki-light:#4E8CA2;">{</span><span style="--shiki-dark:#DCD7BA;--shiki-light:#545464;"> setupCache</span><span style="--shiki-dark:#9CABCA;--shiki-light:#4E8CA2;">,</span><span style="--shiki-dark:#DCD7BA;--shiki-light:#545464;"> buildKeyGenerator</span><span style="--shiki-dark:#9CABCA;--shiki-light:#4E8CA2;"> }</span><span style="--shiki-dark:#957FB8;--shiki-light:#624C83;"> from</span><span style="--shiki-dark:#98BB6C;--shiki-light:#6F894E;"> &#39;axios-cache-interceptor&#39;</span><span style="--shiki-dark:#9CABCA;--shiki-light:#4E8CA2;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#957FB8;--shiki-light:#624C83;">const</span><span style="--shiki-dark:#DCD7BA;--shiki-light:#545464;"> axios </span><span style="--shiki-dark:#E6C384;--shiki-light:#77713F;">=</span><span style="--shiki-dark:#7E9CD8;--shiki-light:#4D699B;"> setupCache</span><span style="--shiki-dark:#9CABCA;--shiki-light:#4E8CA2;">(</span><span style="--shiki-dark:#DCD7BA;--shiki-light:#545464;">Axios</span><span style="--shiki-dark:#9CABCA;--shiki-light:#4E8CA2;">,</span><span style="--shiki-dark:#9CABCA;--shiki-light:#4E8CA2;"> {</span></span>
<span class="line"><span style="--shiki-dark:#DCD7BA;--shiki-light:#545464;">  generateKey</span><span style="--shiki-dark:#9CABCA;--shiki-light:#4E8CA2;">:</span><span style="--shiki-dark:#7E9CD8;--shiki-light:#4D699B;"> buildKeyGenerator</span><span style="--shiki-dark:#9CABCA;--shiki-light:#4E8CA2;">((</span><span style="--shiki-dark:#DCD7BA;--shiki-light:#545464;">request </span><span style="--shiki-dark:#727169;--shiki-light:#716E61;">/* [!code focus:5] */</span><span style="--shiki-dark:#9CABCA;--shiki-light:#4E8CA2;">)</span><span style="--shiki-dark:#957FB8;--shiki-light:#624C83;"> =&gt;</span><span style="--shiki-dark:#9CABCA;--shiki-light:#4E8CA2;"> ({</span></span>
<span class="line"><span style="--shiki-dark:#DCD7BA;--shiki-light:#545464;">    method</span><span style="--shiki-dark:#9CABCA;--shiki-light:#4E8CA2;">:</span><span style="--shiki-dark:#DCD7BA;--shiki-light:#545464;"> request</span><span style="--shiki-dark:#9CABCA;--shiki-light:#4E8CA2;">.</span><span style="--shiki-dark:#E6C384;--shiki-light:#77713F;">method</span><span style="--shiki-dark:#9CABCA;--shiki-light:#4E8CA2;">,</span></span>
<span class="line"><span style="--shiki-dark:#DCD7BA;--shiki-light:#545464;">    url</span><span style="--shiki-dark:#9CABCA;--shiki-light:#4E8CA2;">:</span><span style="--shiki-dark:#DCD7BA;--shiki-light:#545464;"> request</span><span style="--shiki-dark:#9CABCA;--shiki-light:#4E8CA2;">.</span><span style="--shiki-dark:#E6C384;--shiki-light:#77713F;">url</span><span style="--shiki-dark:#9CABCA;--shiki-light:#4E8CA2;">,</span></span>
<span class="line"><span style="--shiki-dark:#DCD7BA;--shiki-light:#545464;">    custom</span><span style="--shiki-dark:#9CABCA;--shiki-light:#4E8CA2;">:</span><span style="--shiki-dark:#7E9CD8;--shiki-light:#4D699B;"> logicWith</span><span style="--shiki-dark:#9CABCA;--shiki-light:#4E8CA2;">(</span><span style="--shiki-dark:#DCD7BA;--shiki-light:#545464;">request</span><span style="--shiki-dark:#9CABCA;--shiki-light:#4E8CA2;">.</span><span style="--shiki-dark:#E6C384;--shiki-light:#77713F;">method</span><span style="--shiki-dark:#9CABCA;--shiki-light:#4E8CA2;">,</span><span style="--shiki-dark:#DCD7BA;--shiki-light:#545464;"> request</span><span style="--shiki-dark:#9CABCA;--shiki-light:#4E8CA2;">.</span><span style="--shiki-dark:#E6C384;--shiki-light:#77713F;">url</span><span style="--shiki-dark:#9CABCA;--shiki-light:#4E8CA2;">)</span></span>
<span class="line"><span style="--shiki-dark:#9CABCA;--shiki-light:#4E8CA2;">  }))</span></span>
<span class="line"><span style="--shiki-dark:#9CABCA;--shiki-light:#4E8CA2;">});</span></span></code></pre></div>`,14)]))}const g=i(h,[["render",n]]);export{C as __pageData,g as default};
